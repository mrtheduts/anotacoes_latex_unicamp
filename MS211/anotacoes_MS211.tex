\documentclass{article}

%encoding
%--------------------------------------
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
%--------------------------------------

%Portuguese-specific commands
%--------------------------------------
\usepackage[brazil]{babel}
%--------------------------------------

%Hyphenation rules
%--------------------------------------
\usepackage{hyphenat}
\hyphenation{mate-mática recu-perar}
%--------------------------------------

%Page formatting
%--------------------------------------
\usepackage[a4paper, margin={1in,1in}, foot=0.5in]{geometry}
\usepackage{multicol}
\usepackage{indentfirst}
\usepackage{enumitem}
\setlist{leftmargin=1.5cm}
%--------------------------------------

%Math
%--------------------------------------
\usepackage{mathtools}
\usepackage{amsmath}
\usepackage{amssymb}
%--------------------------------------

%Plotting Graphs
%--------------------------------------
\usepackage{pgfplots}
\usepackage{tikz}
\usetikzlibrary{positioning}
\usetikzlibrary{graphs}
\usetikzlibrary{calc}
\usetikzlibrary{arrows}
\usetikzlibrary{intersections}
\usetikzlibrary{angles,quotes}
\pgfplotsset{compat=1.16}
%--------------------------------------

%Misc
%--------------------------------------
\usepackage[bottom]{footmisc}
\usepackage{array}
\usepackage{microtype}
\usepackage{xparse}
\usepackage{booktabs}
\usepackage{float}
\usepackage{caption}
\usepackage{textcomp}
\usepackage{mdwlist}
\usepackage{subcaption}
\usepackage{pgffor}
%--------------------------------------

%New Commands
%--------------------------------------
\newcommand*\circled[1]{\tikz[baseline= (char.base)]{
            \node[shape=circle,draw,inner sep=2pt] (char) {#1};}}
%--------------------------------------

\frenchspacing
%\raggedbottom{}
%\raggedright{}

\begin{document}

\title{Anotações MS211\\ \large Aulas ministradas pela\\ Profª Drª Kelly Cristina Poldi}
\author{Eduardo M. F. de Souza}
\date{\today}

\pagenumbering{gobble}
\maketitle

\pagenumbering{arabic}

\tableofcontents
\newpage

\section{Erros em processos Numéricos}

    \subsection{Introdução}

        \begin{multicols}{2}

            Em diversas áreas científicas, os métodos numéricos podem ser usados para resolução de problemas. A resolução de problemas envolve várias fases:

            \begin{center}
                \begin{tikzpicture}[node distance=1.2cm]

                    \node (ProbReal) [rectangle, rounded corners, text centered, draw=black] {Problema Real};
                    \node (ModelMat) [rectangle, rounded corners, text centered, draw=black, below of=ProbReal] {Modelo Matemático};
                    \node (MetSol) [rectangle, rounded corners, text centered, draw=black, below of=ModelMat] {Método de Solução};
                    \node (AnalResul) [rectangle, rounded corners, text centered, draw=black, below of=MetSol] {Análise dos Resultados};

                    \path [->] (ProbReal) edge node [right]{Simplificações} (ModelMat);
                    \path [->] (ModelMat) edge node {} (MetSol);
                    \path [->] (MetSol) edge node {} (AnalResul);
                    \path [->] (AnalResul) edge[bend right=90] node {} (ModelMat);
                    
                \end{tikzpicture}
            \end{center}

            Uma vez resolvido um problema, pode ocorrer que a solução obtida não seja a esperada. Isto porque durante o processo de resolução pode ter ocorrido:

            \begin{enumerate}
                \item Erros de modelagem matemáticas;
                \item Erro de parâmetros;
                \item Erros associados aos sistema de numeração utilizado;
                \item Erros resultantes das operações efetuadas;
                \item Entre outros;
            \end{enumerate}

        \end{multicols}

    \subsection{Representação dos Números}

        A representação de um número depende da base escolhida (ou disponível na máquina utilizada) e o número de dígitos usados na sua representação.

        Exemplo: calcular a área de uma circunferência:
        \begin{align*}
            r &= 1000 m\\
            A &\cong 31400 m^2\\
            A &\cong 31416 m^2\\
            A &\cong 31415,92 m^2
        \end{align*}

        Quanto maior o número de dígitos utilizados, maior será a precisão obtida! Além disso, um número pode ter representação finita em uma base e não finita em outra. Por exemplo:
        \[{(0,2)}_{10} = {(0,0011\overline{0011}\ldots)}_2\]

    \subsection{Conversão de Números nos Sistemas decimal e binário}

        Sistema posicional:
        \begin{align*}
            {(6)}_{10} &= 6\times10^0\\
            {(347)}_{10} &= 3\times10^2 + 4\times10^1 + 7\times10^0\\\\
            {(10111)}_2 &= 1\times2^4 + 0\times2^3 + 1\times2^1 + 1\times2^0\\
            &= {(23)}_{10}
        \end{align*}

        De forma geral, um número $n$ na base $\beta$ é:
        \begin{gather*}
            {(a_j a{j-1} a_{j-2} \cdots a_2 a_1 a_0)}_{\beta},~\mathrm{com}~0 \leq a_k \leq \beta - 1,~\mathrm{e}~k = 1 \ldots j\\
            {(n)}_{\beta}= a_j\beta^j + a_{j-1}\beta^{j-1} + \cdots + a_2\beta^2 + a_1\beta^1 + a_0\beta^0 
        \end{gather*}

        \subsubsection{Mudança da base decimal para a base binária}

            \begin{enumerate}
                \item Parte inteira (Divisões sucessivas):
                    \begin{align*}
                        &{(6)}_{10} = {(?)}_2\\
                        6 \bmod 2 = \boxed{0} \rightarrow \quad &{(6)}_{10} = {(? \ldots \boxed{0})}_2\\
                        \lfloor  6 \div 2 \rfloor = 3 \quad &\\
                        3 \bmod 2 = \boxed{1} \rightarrow \quad &{(6)}_{10} = {(? \ldots \boxed{1}0)}_2\\
                        \lfloor  3 \div 2 \rfloor = 1 \quad &\\
                        1 \bmod 2 = \boxed{1} \rightarrow \quad &{(6)}_{10} = {(? \ldots \boxed{1}10)}_2\\
                        \lfloor  1 \div 2 \rfloor = \underline{0} \quad & \quad \textbf{(Pare!)} \\
                        &{(6)}_{10} = {(110)}_2
                    \end{align*}

                \item Parte fracionária (Multiplicações sucessivas)
                    \begin{align*}
                        &{(0,1875)}_{10} = {(?)}_2\\
                        0,1875 \times 2 = \boxed{0},375 \rightarrow \quad &{(0,1875)}_{10} = {(0.\boxed{0}\ldots~?)}_2\\
                        0,375 - \lfloor 0,375 \rfloor = 0,375 \quad &\\
                        0,375 \times 2 = \boxed{0},75 \rightarrow \quad &{(0,1875)}_{10} = {(0.0\boxed{0}\ldots~?)}_2\\
                        0,75 - \lfloor 0,75 \rfloor = 0,75 \quad &\\
                        0,75 \times 2 = \boxed{1},5 \rightarrow \quad &{(0,1875)}_{10} = {(0.00\boxed{1}\ldots~?)}_2\\
                        1,5 - \lfloor 1,5 \rfloor = 0,5 \quad &\\
                        0,5 \times 2 = \boxed{1},\underline{0} \rightarrow \quad &{(0,1875)}_{10} = {(0.001\boxed{1}\ldots~?)}_2\\
                        \textrm{\textbf{(Pare!)}} \quad &{(0,1875)}_{10} = {(0.0011)}_2
                    \end{align*}
                    
                    \paragraph{Obs:} Alguns números não têm representação finita na base binária --- um ciclo de multiplicações passa a ocorrer. O fato de um número não ter uma representação finita no sistema binário (usado nos computadores) pode acarretar na ocorrência de erros.
                    \begin{align*}
                        &{(0,1)}_{10} = {(?)}_2\\
                        0,1 \times 2 = \boxed{0},2 \rightarrow \quad &{(0,1)}_{10} = {(0.\boxed{0}\ldots~?)}_2\\
                        0,2 \times 2 = \boxed{0},4 \rightarrow \quad &{(0,1)}_{10} = {(0.0\boxed{0}\ldots~?)}_2\\
                        0,4 \times 2 = \boxed{0},8 \rightarrow \quad &{(0,1)}_{10} = {(0.00\boxed{0}\ldots~?)}_2\\
                        0,8 \times 2 = \boxed{1},6 \rightarrow \quad &{(0,1)}_{10} = {(0.0001\boxed{1}\ldots~?)}_2\\
                        0,6 \times 2 = \boxed{1},2 \rightarrow \quad &{(0,1)}_{10} = {(0.0001\boxed{1}\ldots~?)}_2\\
                        0,2 \times 2 = \boxed{0},4 \rightarrow \quad &{(0,1)}_{10} = {(0.00011\boxed{0}\ldots~?)}_2\\
                        0,4 \times 2 = \boxed{0},8 \rightarrow \quad &{(0,1)}_{10} = {(0.000110\boxed{0}\ldots~?)}_2\\
                        \vdots\\
                        &{(0,1)}_{10} = {(0,000110011\overline{0011}\ldots)}_2\\
                    \end{align*}

            \end{enumerate}


        \subsubsection{Mudança da base binária para base decimal:}

            \begin{enumerate}
                    \item Parte inteira: expoentes positivos da direita para a esquerda
                        \begin{align*}
                            {(10011)}_2 &= 1\times2^3 + 0\times2^2 + 1\times2^1 + 1\times2^0\\
                            &= 8 + 0 + 2 + 1\\
                            &= {(11)}_{10}
                        \end{align*}

                    \item Parte fracionária: expoentes negativos da esquerda para direita
                        \begin{align*}
                            {(0.101)}_2 &= 1\times2^{-1} + 0\times2^{-2} + 1\times2^{-3}\\
                            &= 0,5 + 0,125\\
                            &= {(0,625)}_{10}
                        \end{align*}
            \end{enumerate}

            \textbf{Exercício:} escreva ${(1101.011)}_2$ na base decimal:
            \begin{align*}
                {(1101.011)}_2 =&~1\times2^3 + 1\times2^2 + 0\times2^1 + 1\times2^0 +\\
                &+ 0\times2^{-1} + 1\times2^{-2} + 1\times2^{-3}\\
                =&~8 + 4 + 0 + 1 + 0 + 0,25 + 0,125\\
                =&~{(13,375)}_{10}
            \end{align*}

    \subsection{Aritmética de Ponto Flutuante}

        Um número real pode ser representado no sistema de ponto flutuante como:
        \begin{gather*}
            x = m\times\beta^e,~\textrm{em que:}\\
            m = \pm~0,d_1d_2\ldots~d_n,~n \in \mathbb{N}
        \end{gather*}

        Em que:
        \begin{itemize}
            \item $m$ é a mantissa;
            \item $n$ é o número de dígitos na mantissa;
            \item $\beta$ é a base do sistema;
            \item $e$ é o expoente, $e \in \mathbb{Z}:~l\leq~e\leq~u$, sendo que $l$ e $u$ são inteiros fixos;
            \item $d_j$ é o j-ésimo digito da mantissa, sendo que $0\leq~d_j\leq~(\beta - 1),~\textrm{com}~j = 1,~\ldots~,~n$;
            \item $d_1 \neq 0$;
        \end{itemize}

        A reunião de todos os números reais em ponto flutuante mais o zero constitui o \textbf{sistema de ponto flutuante}, denotado por $F(\beta, n, l, u)$. Nesse sistema, o menor número, em valor absoluto, é $(0,1)\times\beta^e$ e o maior valor, em valor absoluto, é $0,(\beta-1)(\beta-1)\ldots(\beta-1)\times\beta^u$. %o beta - 1 é n vezes (esses são os dígitos

        Considere o conjunto dos números reais $\mathbb{R}$ e o seguinte conjunto:
        \[G = \{x \in \mathbb{R} : {\beta}^l \leq |x| < {\beta}^u\}\]

        Dado um número real $x$, três situações podem ocorrer (Exemplos com o caso $F(10, 5, -5, 5)$):

        \begin{enumerate}
                \item $x \in G$: nesse caso, pode-se encontrar valor aproximado de $x,~\overline{x} \in F$.\\
                    Exemplo: $x = 235.89 = 0.23589 \times 10^3$
                \item $|x| < 0.1\beta^l$: $x$ está na condição de \textit{underflow}.\\
                    Exemplo: $x = 0.325 \times 10^{-7}$ ($-7 < l = -5$)
                \item $|x| \ge 0.(\beta-1)(\beta-1)~\ldots~(\beta-1) \times \beta^u$: $x$ está na condição de \textit{overflow}.\\
                    Exemplo: $x = 0.875 \times 10^{\underline{9}}$ ($9 \ge u = 5$)
        \end{enumerate}

        Exemplo: $F(\beta = 10, n = 4, l = -5, u = 5)$
        \begin{itemize}
                \item menor (abs): $0.1 \times 10^{-5}$
                \item maior (abs): $0.9999 \times 10^{5}$
        \end{itemize}
        \[G = \{x \in \mathbb{R} | 10^{-6} \leq x \leq 99990\}\]

        Outros exemplos:
        \begin{itemize}
            \item Truncamento: $x = 423.5\boxed{7} = 0.4235 \times 10^3$
            \item Arredondamento: $x = 423.5\boxed{7} = 0.4236 \times 10^3$
            \item Underflow: $x = 0.5 \times 10^{-9}~(-9 < l = -5)$
            \item Overflow: $x = 0.3 \times 10^8~(8 \ge u = 5)$
        \end{itemize}

    \subsection{Erros}

        Definimos o Erro Absoluto como ${EA}_x$ e o Erro Relativo como ${ER}_x$:
        \begin{gather*}
            {EA}_x = |x - \overline{x}|\\
            {ER}_x = \frac{{EA}_x}{|\overline{x}|} = \frac{|x - \overline{x}|}{|\overline{x}|}
        \end{gather*}

        \subsubsection{Erros de Arredondamento e Truncamento}

            Considere um sistema de ponto flutuante com $n$ dígitos e base $10$. Podemos escrever $x$ como:
            \begin{gather*}
                x = f_x \times 10^e + g_x \times 10^{e-n}~|~0.1 \leq f_x < 1,~ 0 \leq g_x < 1
            \end{gather*}

            Exemplo com $x=234,57$ e $n=4$:
            \begin{align*}
                x &= 234,57\\
                &= 2 \times 10^2 + 3 \times 10^1 + 4 \times 10^0 + 5 \times^{-1} + 7 \times 10^{-2}\\
                &= (2 \times 10^{-1} + 3 \times 10^{-2} + 4 \times 10^{-3} + 5 \times 10^{-4}) \times 10^3 + (7 \times 10^-1) \times 10^{-1}\\
                &= 0.2345 \times 10^{3} + 0.7 \times 10^{-1}\\
            \end{align*}
            
            Dessa forma, obtemos:
            \begin{align*}
                f_x &= 0.2345               &               e &= 3\\
                g_x &= 0.7 \times 10^{-1}   &               e-n &= -1\\
            \end{align*}


            Para representar $x$ nesse sistema, podemos usar dois critérios:
            \begin{itemize}
                \item \textbf{Truncamento:} $\overline{x} = f_x \times 10^e$ e $g_x \times 10^{e-n}$ é desprezado;
                    \begin{gather*}
                        |EA_x| < 10^{e-n}\\
                        |ER_x| < 10^{-n+1}
                    \end{gather*}

                    Ex: $\overline{x} = 0.2345 \times 10^3$

                \item \textbf{Arredondamento:} $\overline{x} = \begin{cases}
                        f_x  \times 10^e, & \text{se $|g_x| < \frac{1}{2}$}\\
                        f_x  \times 10^e  + 10^{e - n}, & \text{se $|g_x| \geq \frac{1}{2}$}\\
                    \end{cases}$
                    \begin{gather*}
                        |EA_x| < \frac{1}{2} \times 10^{e-n}\\
                        |ER_x| < \frac{1}{2} \times 10^{-n+1}
                    \end{gather*}

                    Ex: $\overline{x} = 0.23456 \times 10^3$
            \end{itemize}
            
            Dessa forma, temos $|EA_x|$ e $|ER_x|$ como:
            \begin{align*}
                |EA_x| &= |x - \overline{x}| \\
                &= |f_x \times 10^e + g_x \times 10^{e-n} - f_x \times 10^e|\\
                &= |g_x \times 10^{e-n}|\\
                10^{e-n} &> |g_x \times 10^{e-n}|\\
            \end{align*}

            \begin{align*}
                {ER}_x &= \frac{{EA}_x}{|\overline{x}|}\\
                &= \frac{|x - \overline{x}|}{|\overline{x}|}\\
                &= \frac{|f_x \times 10^e + g_x \times 10^{e-n} - f_x \times 10^e|}{|f_x \times 10^e|}\\
                &= \frac{g_x}{f_x} \times \frac{10^{e-n}}{10^e}\\
                &= \frac{g_x}{f_x} \times 10^{-n}\\
                \\
                \text{Como $g_x$ é dez vezes menor que}& \text{ $f_x$, temos que:}\\
                10^{-n + 1} &> \frac{g_x}{f_x} \times 10^{-n}
            \end{align*}


        \subsubsection{Teorema de Taylor}

            Suponha $f \in C^n[a,b]$. $f^{n-1}$ existe em $[a,b]$ e $x_0 \in [a,b]$ e $\forall x \in [a,b], \exists~\xi(x)$ entre $x$ e $x_0$ com
            $f(x) = P_n(x) + R_n(x)$, onde:

            \begin{gather*}
                P_n(x) = f(x_0) + f^{(1)}(x_0)(x - x_0) + f^{(2)}(x_0)\frac{{(x-x_0)}^2}{2!} + \cdots + f^{(n)}(x_0)\frac{{(x-x_0)}^n}{n!}\\
                = \sum_{k=0}^{n} f^{(k)}(x_0) \times \frac{{(x - x_0)}^k}{k!}\\
                R_n(x) = f^{(n+1)}(\xi(x)) \times \frac{{(x - x_0)}^{n+1}}{(n + 1)!}\\
            \end{gather*}

            $P_n(x)$ é chamado de polinômio de taylor de ordem $n$ para $f$ em torno de $x_0$ e $R_n(x)$ é o resto (erro de truncamento) associado à $P_n(x)$.

            \paragraph{Obs:} A série infinita obtida fazendo-se o limite $\lim_{n \to \infty} P_n(x)$ é chamada de série de Taylor de $f$ em torno de $x_0$. No caso $x_0 = 0$, chamamos de polinômio de McLaurin (e série de McLaurin). Por exemplo, para calcular o valor de $e^{0.5}$:

            \begin{gather*}
                f(x) = e^x,~f^{(1)}(x) = e^x,~f^{(2)}(x) = e^x,~\ldots
            \end{gather*}

            Série de Taylor ($x_0 = 0$):

            \begin{gather*}
                = f(0) + f^{(1)}(0)(x - 0) + f^{(2)}(0)\frac{{(x - 0)}^2}{2!} + f^{(3)}(x)\frac{{(x - 0)}^3}{3!} + \cdots + f^{(n)}(0)\frac{{(x-0)}^n}{n!}\\
                = e^0 + e^0(x) + \frac{e^0{(x)}^2}{2!} + \frac{e^0{(x)}^3}{3!} + \cdots + \frac{e^0x^n}{n!} + \cdots\\
                = 1 + x + \frac{x^2}{2!} + \frac{x^3}{3!} + \cdots + \frac{x^n}{n!} + \cdots
            \end{gather*}

            Para o cálculo de $e^{0.5}$, precisamos \underline{truncar} a série, usando apenas um número finito de termos da série. Por exemplo, usando os \underline{seis primeiros termos} ($n = 5$), como aproximação:

            \begin{align*}
                e^x &\approxeq 1 + x + \frac{x^2}{2!} + \frac{x^3}{3!} + \frac{x^4}{4!} + \frac{x^5}{5!}\\
                e^{0.5} &\approxeq 1 + 0.5 + \frac{0.5^2}{2} + \frac{0.5^3}{6} + \frac{0.5^4}{24} + \frac{0.5^5}{120}\\
                &= 1.5 + 0.125 + 0.0208333 + 0.002604166 + 0.00026041666\\
                &= 1.648697
            \end{align*}

            O erro de truncamento é dado por:
            \begin{align*}
            R_n(x) &= f^{(n+1)}(\xi_x) \times \frac{{(x - x_0)}^{n_1}}{(n+1)!}\\
            &= f^{(6)}(\alpha) \times \frac{{(x - 0)}^6}{6!}\\
			\text{Neste caso:}&\\
			&\frac{\alpha^6}{6!},\text{ com }0 \leq \alpha \leq 0.5
            \end{align*}

            Estimativa para o erro, faço $\alpha = 0.5$:
			\begin{align*}
				R_n(x) \leq \gamma &= \frac{0.5^6}{720}\\
				&= 0.217 \times 10^{-6}
			\end{align*}

            \newpage

    \subsection{Zeros reais de funções reais}
        \paragraph{Definição:} um número real $\xi$ é um zero da função $f(x)$ ou uma raíz da equação $f(x)=0$ se $f(\xi)=0$.

        % Não sei porque a professora colocou essa figura aqui
		%\begin{figure}[H]
			%\centering
			%\begin{tikzpicture}
				%\begin{axis}[
					%axis lines = center,
					%xlabel = $x$,
					%ylabel = {$f(x)$},
					%legend style={
						%cells={anchor=east},
						%legend pos=north west,
					%},
				%]
					%\addlegendentry{$x^2 - 2x - 1$}
					%\addplot [
						%domain=-4:2, 
						%samples=100, 
						%color=blue,
						%]
						%{x^2 + 2*x + 1};
				%\end{axis}
			%\end{tikzpicture}
		%\end{figure}

        Para calcularmos raízes reais, os métodos numéricos geralmente são de duas fases:

        \begin{enumerate}
            \item \textbf{Determinar uma aproximação inicial:} localizar ou isolar as raízes (ou seja, determinar umintervalo que contenha a raiz);
            \item \textbf{Refinamento:} melhorar essa aproximação usando métodos iterativos (obter aproximações dentro de uma precisão $\varepsilon$ fixada);
        \end{enumerate}

        \subsubsection{Fase 1: Localizar raízes de $f(x)$}
        \paragraph{Teorema:} Seja $f(x)$ contínua em $[a,b]$. Se $f(a) \times f(b) < 0$, então pelo menos temos um ponto $\xi$ tal que $f(\xi) = 0$

		\begin{figure}[H]
			\centering
			\begin{tikzpicture}[>=latex', x=3cm, y=2cm]
                \draw[->, thick](0,-1)--(0,1)node[anchor=south]{$f(x)$};
                \draw[->, thick](-0.025,0)--(3,0)node[anchor=west]{$x$};

                \draw[-,thick,name path=line](0,0.9)--(2.9,-0.9);

                \coordinate(a) at (0.5,0);
                \coordinate(xi) at (1.5,0);
                \coordinate(b) at (2.5,0);

                \path[name path=linea](a)--+(0,1);
                \path[name intersections={of=line and linea}](intersection-1) coordinate(intera);
                \coordinate (yposa) at (intera -| {(0,0)});
                \draw[dashed] (a) |- (yposa);
                \node[anchor=east] at (yposa){$f(a)$};
                \node[anchor=north] at (a){$a$};

                \node[anchor=south] at (xi){$\xi$};
                \node[anchor=east] at (0,0){$0$};

                \path[name path=lineb](b)--+(0,-1);
                \path[name intersections={of=line and lineb}](intersection-1) coordinate(interb);
                \coordinate (yposb) at (interb -| {(0,0)});
                \draw[dashed] (b) |- (yposb);
                \node[anchor=east] at (yposb){$f(b)$};
                \node[anchor=south] at (b){$b$};

			\end{tikzpicture}
		\end{figure}

        \subsubsection*{Método gráfico}
        Pode ser utilizado para obter uma aproximação inicial para a raiz. Ela consiste em \underline{uma} das seguintes alternativas:

        \begin{enumerate}
            \item Ou construir o gráfico de $y=f(x)$ e obter sua intersecção com o eixo $\vec{Ox}$;
            \item Ou escrever $f(x)$ na forma $g(x) = h(x)$ e obter a intersecção dos gráficos $g(x) - h(x) = 0 = f(x)$;
        \end{enumerate}

        \paragraph{Exemplos:}
        \begin{enumerate}[label= \textbf{(\alph*)}]
            \item $f(x) : x^2 - x - 2 = 0$
                \begin{figure}[H]

                    \begin{subfigure}{0.5\textwidth}
                        \centering
                        \begin{tikzpicture}
                            \begin{axis}[
                                axis lines = center,
                                xlabel = $x$,
                                ylabel = {$f(x)$},
                                ]
                                \addplot[
                                domain=-2:3, 
                                samples=100, 
                                color=blue,
                                ]
                                {x^2-x-2};
                                \addlegendentry{$f(x)$}
                            \end{axis}
                        \end{tikzpicture}
                        \caption*{(1)}
                    \end{subfigure}
                    \begin{subfigure}{0.5\textwidth}
                        \centering
                        \begin{tikzpicture}
                            \begin{axis}[
                                axis lines = center,
                                xlabel = $x$,
                                ylabel = {$f(x)$},
                                ]
                                \addplot [
                                    domain=-2:3, 
                                    samples=100, 
                                    color=blue,
                                    ]
                                    {x^2};
                                \addlegendentry{$g(x) = x^2$}
                                \addplot [
                                    domain=-2:3, 
                                    samples=100, 
                                    color=red,
                                    ]
                                    {x + 2};
                                \addlegendentry{$h(x) = x + 2$}
                                \addplot[dashed] coordinates {(2,0)(2,4)};
                                \addplot[dashed] coordinates {(-1,0)(-1,0.8)};
                            \end{axis}
                        \end{tikzpicture}
                        \caption*{(2)}
                    \end{subfigure}
                \end{figure}

            \item $f(x) : x^2 - e^x = 0$
                \begin{figure}[H]

                    \begin{subfigure}{0.5\textwidth}
                        \centering
                        \begin{tikzpicture}
                            \begin{axis}[
                                axis lines = center,
                                xlabel = $x$,
                                ylabel = {$f(x)$},
                                ]
                                \addplot[
                                domain=-2:2, 
                                samples=100, 
                                color=blue,
                                ]
                                {x^2-e^x};
                                \addlegendentry{$f(x)$}
                            \end{axis}
                        \end{tikzpicture}
                        \caption*{(1)}
                    \end{subfigure}
                    \begin{subfigure}{0.5\textwidth}
                        \centering
                        \begin{tikzpicture}
                            \begin{axis}[
                                axis lines = center,
                                xlabel = $x$,
                                ylabel = {$f(x)$},
                                ]
                                \addplot [
                                    domain=-2:2, 
                                    samples=100, 
                                    color=blue,
                                    ]
                                    {x^2};
                                \addlegendentry{$g(x) = x^2$}
                                \addplot [
                                    domain=-2:2, 
                                    samples=100, 
                                    color=red,
                                    ]
                                    {e^x};
                                \addlegendentry{$h(x) = e^x$}
                                \addplot[dashed] coordinates {(-0.7,0)(-0.7,0.5)};
                            \end{axis}
                        \end{tikzpicture}
                        \caption*{(2)}
                    \end{subfigure}
                \end{figure}

            \item $f(x) : \log{x} + x = 0$
                \begin{figure}[H]

                    \begin{subfigure}{0.5\textwidth}
                        \centering
                        \begin{tikzpicture}
                            \begin{axis}[
                                axis lines = center,
                                xlabel = $x$,
                                ylabel = {$f(x)$},
                                ]
                                \addplot[
                                domain=-2:2, 
                                samples=100, 
                                color=blue,
                                ]
                                {log2(x) + x};
                                \addlegendentry{$f(x)$}
                            \end{axis}
                        \end{tikzpicture}
                        \caption*{(1)}
                    \end{subfigure}
                    \begin{subfigure}{0.5\textwidth}
                        \centering
                        \begin{tikzpicture}
                            \begin{axis}[
                                axis lines = center,
                                xlabel = $x$,
                                ylabel = {$f(x)$},
                                ]
                                \addplot [
                                    domain=-2:2, 
                                    samples=100, 
                                    color=blue,
                                    ]
                                    {log2(x)};
                                \addlegendentry{$g(x) = log(x)$}
                                \addplot [
                                    domain=-2:2, 
                                    samples=100, 
                                    color=red,
                                    ]
                                    {-x};
                                \addlegendentry{$h(x) = -x$}
                                \addplot[dashed] coordinates {(0.64,0)(0.64,-0.62)};
                            \end{axis}
                        \end{tikzpicture}
                        \caption*{(2)}
                    \end{subfigure}
                \end{figure}

        \end{enumerate}

        \subsubsection{Fase 2: Refinamento}
        Métodos iterativos para se obter zeros de funções:
        \begin{itemize}
            \item ponto inicial;
            \item sequência de instruções (iterações);
            \item critério de parada;
        \end{itemize}

        \begin{gather*}
            |-f(x)| < \varepsilon\\
            |x_{k-1} - x_k| < \varepsilon
        \end{gather*}

        \subsubsection{Método da Bisseção}
        Seja $f$ uma função contínua em $[a,b]$ e suponha $f(a) \times f(b) < 0$ (ou seja, existe raiz real). Para simplificar, vamos supor que existe uma única raíz real em $[a,b]$. O método da bisseção consistem em determinar uma sequência de intervalos $[a_i,b_i],~i = 1,~2,~\ldots$ de tal forma que $[a_i,b_i]$ sempre contenha a raíz.

        % Grafico que tem uma função que passa do negativo para o positivo no intervalo [a,b], sendo que x_1 = (a1+b1)/2. Iterativamente, vai diminuindo a e b pelo novo valor de x
		\begin{figure}[H]
			\centering
            \caption*{1ª iteração}
			\begin{tikzpicture}[>=latex', x=3cm, y=2cm]

                \draw[->](0,-1)--(0,1)node[anchor=south]{$f(x)$};
                \draw[->, name path=xaxis](-0.025,0)--(3,0)node[anchor=west]{$x$};
                \node[anchor=east] at (xaxis){$0$};

                \draw[-, name path=line](0,0.9)--(2.9,-0.9);

                \path[name intersections={of=line and xaxis}](intersection-1) coordinate(xi);
                \node[anchor=south] at (xi){$\xi$};
                \draw[-](xi)-- ++(0,0.03);
                \draw[-](xi)-- ++(0,-0.03);

                \coordinate(a1) at (0.75,0);
                \coordinate(b1) at (2.7,0);

                \draw[-] (a1)--(b1);

                \path[name path=linea1](a1)--+(0,1);
                \path[name intersections={of=line and linea1}](intersection-1) coordinate(intera1);
                \coordinate (yposa1) at (intera1 -| {(0,0)});
                \draw[dashed] (a1) |- (yposa1);
                \node[anchor=east] at (yposa1){$f(a_1)$};
                \node[anchor=north] at (a1){$a_1$};

                \path[name path=lineb1](b1)--+(0,-1);
                \path[name intersections={of=line and lineb1}](intersection-1) coordinate(interb1);
                \coordinate (yposb1) at (interb1 -| {(0,0)});
                \draw[dashed] (b1) |- (yposb1);
                \node[anchor=east] at (yposb1){$f(b_1)$};
                \node[anchor=south] at (b1){$b_1$};

                \coordinate(x1) at (1.725,0);
                \node[anchor=south west] at ([xshift=-0.3cm] x1){$x_1 = b_2$};
                \draw[-](x1)-- ++(0,0.03);
                \draw[-](x1)-- ++(0,-0.03);

			\end{tikzpicture}
		\end{figure}

		\begin{figure}[H]
			\centering
            \caption*{2ª iteração}
			\begin{tikzpicture}[>=latex', x=3cm, y=2cm]

                \draw[->](0,-1)--(0,1)node[anchor=south]{$f(x)$};
                \draw[->, name path=xaxis](-0.025,0)--(3,0)node[anchor=west]{$x$};
                \node[anchor=east] at (xaxis){$0$};

                \draw[-, name path=line](0,0.9)--(2.9,-0.9);

                \path[name intersections={of=line and xaxis}](intersection-1) coordinate(xi);
                \node[anchor=south] at (xi){$\xi$};
                \draw[-](xi)-- ++(0,0.03);
                \draw[-](xi)-- ++(0,-0.03);

                \coordinate(a2) at (0.75,0);
                \coordinate(b2) at (1.725,0);

                \path[name path=linea2](a2)--+(0,1);
                \path[name intersections={of=line and linea2}](intersection-1) coordinate(intera2);
                \coordinate (yposa2) at (intera2 -| {(0,0)});
                \draw[dashed] (a2) |- (yposa2);
                \node[anchor=east] at (yposa2){$f(a_2)$};
                \node[anchor=north] at (a2){$a_2$};

                \path[name path=lineb2](b2)--+(0,-1);
                \path[name intersections={of=line and lineb2}](intersection-1) coordinate(interb2);
                \coordinate (yposb2) at (interb2 -| {(0,0)});
                \draw[dashed] (b2) |- (yposb2);
                \node[anchor=east] at (yposb2){$f(b_2)$};
                \node[anchor=south] at (b2){$b_2$};

                \coordinate(x2) at (1.2375,0);
                \node[anchor= north east] at ([xshift=0.35cm] x2){$a_3 = x_2$};
                \draw[-](x2)-- ++(0,0.03);
                \draw[-](x2)-- ++(0,-0.03);

			\end{tikzpicture}
		\end{figure}

		\begin{figure}[H]
			\centering
            \caption*{3ª iteração}
			\begin{tikzpicture}[>=latex', x=3cm, y=2cm]

                \draw[->](0,-1)--(0,1)node[anchor=south]{$f(x)$};
                \draw[->, name path=xaxis](-0.025,0)--(3,0)node[anchor=west]{$x$};
                \node[anchor=east] at (xaxis){$0$};

                \draw[-, name path=line](0,0.9)--(2.9,-0.9);

                \path[name intersections={of=line and xaxis}](intersection-1) coordinate(xi);
                \node[anchor=south] at (xi){$\xi$};
                \draw[-](xi)-- ++(0,0.03);
                \draw[-](xi)-- ++(0,-0.03);

                \coordinate(a3) at (1.2375,0);
                \coordinate(b3) at (1.725,0);

                \path[name path=linea3](a3)--+(0,1);
                \path[name intersections={of=line and linea3}](intersection-1) coordinate(intera3);
                \coordinate (yposa3) at (intera3 -| {(0,0)});
                \draw[dashed] (a3) |- (yposa3);
                \node[anchor=south east] at (yposa3){$f(a_3)$};
                \node[anchor=north] at (a3){$a_3$};

                \path[name path=lineb3](b3)--+(0,-1);
                \path[name intersections={of=line and lineb3}](intersection-1) coordinate(interb3);
                \coordinate (yposb3) at (interb3 -| {(0,0)});
                \draw[dashed] (b3) |- (yposb3);
                \node[anchor=north east] at (yposb3){$f(b_3)$};
                \node[anchor=south] at (b3){$b_3$};

                \coordinate(x3) at (1.48125,0);
                \node[anchor= north] at ([xshift=0.09cm]x3){$ x_3$};
                \draw[-](x3)-- ++(0,0.03);
                \draw[-](x3)-- ++(0,-0.03);

			\end{tikzpicture}
		\end{figure}


        De forma geral:
        \begin{gather*}
            x_i = \frac{a_i + b_i}{2}\\
            f(a_i) \times f(x_i) =
                \begin{cases}
                    < 0,~ & \text{então}
                        \begin{cases}
                            a_{i+1} = a_i\\
                            b_{i+1} = x_i\\
                        \end{cases}\\
                    > 0,~ & \text{então}
                        \begin{cases}
                            a_{i+1} = x_i\\
                            b_{i+1} = b_i\\
                        \end{cases}\\
                \end{cases}\\
        \end{gather*}

        \paragraph{Critério de Parada:} $|b_k - a_k| < \varepsilon$

        \subsubsection*{Estimativa para o número de iterações}
        Na iteração $k$, temos que:
        \begin{align*}
            b_k - a_k &= \frac{b_{k-1} - a_{k-1}}{2}\\
            &= \frac{b_0 - a_0}{2^k}
        \end{align*}

        Queremos saber o valor de $k$ tal que $b_k - a_k < \varepsilon$, ou seja:

        \begin{gather*}
            \frac{b_0 - a_0}{2^k} < \varepsilon\\
            2^k \varepsilon > b_0 - a_0\\
            2^k > \frac{b_0 - a_0}{\varepsilon}\\
            k \times \log{2} > \log{(b_0 - a_0)} - \log{\varepsilon}\\
            \boxed{k > \frac{\log{(b_0 - a_0)} - \log{\varepsilon}}{\log{2}}}
        \end{gather*}

        \paragraph{Exemplo:} $f(x) : x^3 + 3x - 1= 0$, com $[a,b] = [0,1]$ e $\varepsilon = 10^{-1}$

        \begin{align*}
            f(a = a_1) &= f(0)  &   f(b = b_1) &= f(1)\\
            f(0) &= -1          &   f(1) &= 3\\
            -1 &< 0             &   3 &> 0
        \end{align*}

        \[f(a) \times f(b) < 0 \rightarrow \text{Ok!}\]

        \begin{align*}
            k &= 1          &           x_1 &= \frac{a_1 + b_1}{2}      &       b_2 &= 0,5\\
            &               &           &= 0,5                          &       f(b_2) &= 0,625\\
            &               &           &                               &       0,625 &> 0\\
            \\
            &               &           \xi &\in [0,0.5]\\
            &               &           |b_2 - a_2| &= 0,5 > \varepsilon\\
            \\
            k &= 2          &           x_2 &= \frac{a_2 + b_2}{2}      &       a_3 &= 0,25\\
            &               &           &= 0,25                         &       f(a_3) &= -0,23437\\
            &               &           &                               &       -0,23437 &< 0\\
            \\
            &               &           \xi &\in [0.25,0.5]\\
            &               &           |b_3 - a_3| &= 0,25 > \varepsilon
        \end{align*}
        \begin{align*}
            k &= 3          &           x_3 &= \frac{a_3 + b_3}{2}      &       a_4 &= 0,375\\
            &               &           &= 0,375                        &       f(a_4) &= -0,1777\\
            \\
            &               &           \xi &\in [0.375,0.5]\\
            &               &           |b_4 - a_4| &= 0,125 > \varepsilon\\
            \\
            k &= 3          &           x_4 &= \frac{a_4 + b_4}{2}      &       a_5 &= 0,3125\\
            &               &           &= 0,375                        &       f(a_5) &= -0,0319824\\
            \\
            &               &           \xi &\in [0.3125,0.5]\\
            &               &           |b_5 - a_5| &= \boxed{0,0625 < \varepsilon}\\
            &               &           &\text{\textbf{Pare!}}\\
        \end{align*}

        Estimativa para o número de iterações:
        \begin{cases*}
            a_0 = 0\\
            b_0 = 1\\
        \end{cases*}, $\varepsilon = 0,1$.

        \begin{gather*}
            k > \frac{\log{(b_0 - a_0)} - \log{(\varepsilon)}}{\log{2}}\\
            k > \frac{\log{(1 - 0)} - \log{(0,1)}}{\log{2}}\\
            k > \frac{\log{(1)} - \log{(10^{-1})}}{\log{2}}\\
            k > \frac{\log{(1)} + \log{(10)}}{\log{2}}\\
            k > 1,5
        \end{gather*}

        \subsubsection*{Sobre a convergência}
        A convergência está garantida, visto que $a_i \leq x_i \leq b_i$, sendo $a_i$ crescente (não-decrescente) e $b_i$ decrescente (não-crescente).

        Porém, ela é muito lenta: se o intervalo iniciar $a_0 - a_0 \ll \varepsilon$ e $\varepsilon$ for muito pequeno, o número de iterações tende a ser muito grande. Exemplo:

        \begin{align*}
            \left. \begin{array}{r}
                |b_0 - a_0| = 3\\
                \varepsilon = 10^{-7}
            \end{array} \right\} \to{} k &> \frac{\log{(3)}-\log{(10^{-7})}}{\log{(2)}}\\
            k &\approxeq{} 24,8384\\
            k &= 25~\text{iterações}
        \end{align*}

        \subsubsection{Método do Ponto Fixo}
        Seja $f(x)$ uma função contínua em $[a,b]$ e existe pelo menos uma raiz $\xi$ neste intervalo. O método consiste em transformar esta equação em uma equação equivalente $x = \varphi(x)$ e, a partir de uma aproximação inicial $x_0$, gerar uma sequência de aproximações $\{x_k\}$ para $\xi$, usando a relação: $x_{k+1} = \varphi(x_k)$.

        A função $\varphi(x)$ é tal que $f(\xi) = 0$ se e somente se $\varphi(\xi) = \xi$. Assim, encontrar um zero de $f(x)$ é equivalente a encontrar um ponto fixo para $\varphi(x)$.

        Uma função que satisfaz essa condição é chamada de \underline{função de iteração} para a equação $f(x) = 0$.
        
        \paragraph{Exemplos:} $f(x) : x^2 + x - 6 = 0$. São funções de iteração:
        \begin{enumerate}[label= \textbf{(\alph*)}]
            \item $x = 6 - x^2  \to{} \varphi_1(x) = 6 - x^2$    
            \item \begin{array}{r}x^2 = 6 - x\\
                  x = \pm \sqrt{6 - x}\end{array} $\to{} \varphi_2(x) = \pm \sqrt{6 - x}$
            \item \begin{array}{r} x(x+1)-6 = 0\\
                  x = \frac{6}{x + 1}\end{array} $\to{} \varphi_3(x) = \frac{6}{x+1}$
        \end{enumerate}

        \paragraph{Obs:} Podem existir infinitas funções de iteração $\varphi(x)$ para uma $f(x) = 0$.\\

        A forma geral das funções de iteração se dá por:
        \[\varphi(x) = x + A(x).f(x)\]
        com a condição de que, em $\xi$, ponto fixo de $\varphi(x)$, se tenha $A(\xi) \neq 0$.

        \paragraph{Mostremos que} $f(\xi) = 0 \iff \varphi(\xi) = \xi$:
        \begin{itemize}
            \item[(\Rightarrow)] Seja $\xi$ tal que $f(\xi) = 0$.
                \begin{align*}
                    \varphi(\xi) &= \xi + A(\xi).f(\xi)\\
                    \varphi(\xi) &= \xi + A(\xi).0\\
                    \varphi(\xi) &= \xi
                \end{align*}
            \item[(\Leftarrow)] Seja $\varphi(\xi) = \xi$. Assim,
                \begin{align*}
                    \left.\begin{array}{l} \varphi(\xi) = \xi + A(\xi).f(\xi)\\ \varphi(\xi) = \xi\end{array}\right\}
                    \Rightarrow{} A (\xi).f (\xi) = 0
                \end{align*}
                Como $A(\xi) \neq 0$, temos que $f(\xi) = 0$.\quad\square{}{}
        \end{itemize}

        \paragraph{Interpretação Geométrica:} Graficamente, uma raiz da equação $x = \varphi(x)$ é a abscissa do ponto de intersecção da reta $y = x$ e da curva $y = \varphi(x)$.

        \begin{figure}[H]
            \begin{subfigure}{0.5\textwidth}
                \centering
                \begin{tikzpicture}[>=latex']

                    \draw[->, name path=yaxis](0,-0.25)--(0,4) node[anchor=south]{$y$};
                    \draw[->, name path=xaxis](-0.25,0)--(4.5,0) node[anchor=west]{$x$};

                    \draw[-, color=blue, name path=line](-0.25,-0.25)--(4,4) node[anchor=south west]{$y = x$};
                    \draw[color=red, name path=phi] (-0.25, 0.5) parabola (4,2.5) node[anchor=south west] {$\varphi(x)$};

                    \path[name intersections={of=line and phi,by=posxi}];
                    \path[name path=xipos](posxi)--+(0,-1);
                    \path[name intersections={of=xipos and xaxis,by=xi}];

                    \draw[dashed](posxi)--(xi) node[anchor=north]{$\xi$};
                    \draw[-](xi)-- ++(0,0.05);
                    \draw[-](xi)-- ++(0,-0.05);

                    \coordinate(x0) at (3.5,0);
                    \node[anchor=north] at (x0){$x_0$};
                    \draw[-](x0)-- ++(0,0.05);
                    \draw[-](x0)-- ++(0,-0.05);

                    \path[name path=linex0](x0)--+(0,4)
                    \path[name intersections={of=linex0 and phi,by=posphix0}];
                    \draw[dashed] (x0)--(posphix0);

                    \path[name path=x0tox1](posphix0)--+(-4,0);
                    \path[name intersections={of=x0tox1 and line,by=posyx1}];
                    \draw[->] (posphix0)--(posyx1);

                    \path[name intersections={of=x0tox1 and yaxis,by=y1}];
                    \draw[dashed] (posyx1)--(y1);
                    \node[anchor = east] at (y1) {\small{$\varphi(x_0) = y_1 = x_1$}}

                    \path[name path=findx1](posyx1)--+(0,-2.5);
                    \path[name intersections={of=findx1 and phi,by=posphix1}];
                    \draw[->] (posyx1)--(posphix1);

                    \path[name intersections={of=findx1 and xaxis,by=x1}];
                    \draw[dashed] (x1)--(posphix1);

                    \node[anchor=north] at (x1){$x_1$};
                    \draw[-](x1)-- ++(0,0.05);
                    \draw[-](x1)-- ++(0,-0.05);

                    \path[name path=x1tox2](posphix1)--+(-3,0);
                    \path[name intersections={of=x1tox2 and line,by=posyx2}];
                    \draw[->] (posphix1)--(posyx2);

                    \path[name intersections={of=x1tox2 and yaxis,by=y2}];
                    \draw[dashed] (posyx2)--(y2);
                    \node[anchor = east] at (y2) {\small{$\varphi(x_1) = y_2 = x_2$}}

                    \path[name path=findx2](posyx2)--+(0,-2);
                    \path[name intersections={of=findx2 and phi,by=posphix2}];
                    \draw[->] (posyx2)--(posphix2);

                    \path[name intersections={of=findx2 and xaxis,by=x2}];
                    \draw[dashed] (x2)--(posphix2);
                    \node[anchor=north] at (x2){$x_2$};
                    \draw[-](x2)-- ++(0,0.05);
                    \draw[-](x2)-- ++(0,-0.05);

                    \path[name path=x2tox3](posphix2)--+(-2,0);
                    \path[name intersections={of=x2tox3 and line,by=posyx3}];
                    \draw[->] (posphix2)--(posyx3);

                    \path[name intersections={of=x2tox3 and yaxis,by=y3}];
                    \draw[dashed] (posyx3)--(y3);
                    \node[anchor = east] at (y3) {\small{$\varphi(x_2) = y_3 = x_3$}}

                \end{tikzpicture}
                \caption*{\centering $\{x_k\} \to{} \xi$ quando $k \to{\infty}$}
            \end{subfigure}
            \begin{subfigure}{0.5\textwidth}
                \centering
                \begin{tikzpicture}[>=latex']

                    \draw[->, name path=yaxis](0,-0.25)--(0,4) node[anchor=south]{$y$};
                    \draw[->, name path=xaxis](-0.25,0)--(4.5,0) node[anchor=west]{$x$};

                    \draw[-, color=blue, name path=line](-0.25,-0.25)--(4,4) node[anchor=south west]{$y = x$};
                    \draw[color=red, name path=phi] (0.5, -0.25) parabola bend (3.5,4) (3.5,4) node[anchor=south east] {$\varphi(x)$};

                    \path[name intersections={of=line and phi,by=posxi}];
                    \path[name path=xipos](posxi)--+(0,-1);
                    \path[name intersections={of=xipos and xaxis,by=xi}];

                    \draw[dashed](posxi)--(xi) node[anchor=north]{$\xi$};
                    \draw[-](xi)-- ++(0,0.05);
                    \draw[-](xi)-- ++(0,-0.05);

                    \coordinate(x0) at (1.5,0);
                    \node[anchor=north] at (x0){$x_0$};
                    \draw[-](x0)-- ++(0,0.05);
                    \draw[-](x0)-- ++(0,-0.05);

                    \path[name path=linex0](x0)--+(0,3)
                    \path[name intersections={of=linex0 and phi,by=posphix0}];
                    \draw[dashed] (x0)--(posphix0);

                    \path[name path=x0tox1](posphix0)--+(4,0);
                    \path[name intersections={of=x0tox1 and line,by=posyx1}];
                    \draw[->] (posphix0)--(posyx1);

                    \path[name path=findy1](posyx1)--+(-4,0);
                    \path[name intersections={of=findy1 and yaxis,by=y1}];
                    \draw[dashed] (posyx1)--(y1);
                    \node[anchor = east] at (y1) {\small{$\varphi(x_0) = y_1 = x_1$}}

                    \path[name path=findx1](posyx1)--+(0,-3);
                    \path[name intersections={of=findx1 and xaxis,by=x1}];
                    \draw[dashed] (posyx1)--(x1);

                    \path[name path=findx1onphi](posyx1)--+(0,2);
                    \path[name intersections={of=findx1onphi and phi,by=posphix1}];
                    \draw[->] (posyx1)--(posphix1);

                    \node[anchor=north] at (x1){$x_1$};
                    \draw[-](x1)-- ++(0,0.05);
                    \draw[-](x1)-- ++(0,-0.05);

                    \path[name path=x1tox2](posphix1)--+(3,0);
                    \path[name intersections={of=x1tox2 and line,by=posyx2}];
                    \draw[->] (posphix1)--(posyx2);

                    \path[name path=findy2](posyx2)--+(-4,0);
                    \path[name intersections={of=findy2 and yaxis,by=y2}];
                    \draw[dashed] (posyx2)--(y2);
                    \node[anchor = east] at (y2) {\small{$\varphi(x_1) = y_2 = x_2$}}

                    \path[name path=findx2onphi](posyx2)--+(0,2);
                    \path[name intersections={of=findx2onphi and phi,by=posphix2}];
                    \draw[->] (posyx2)--(posphix2);

                    \path[name path=findx2](posyx2)--+(0,-4);
                    \path[name intersections={of=findx2 and xaxis,by=x2}];
                    \draw[dashed] (x2)--(posphix2);

                    \node[anchor=north] at (x2){$x_2$};
                    \draw[-](x2)-- ++(0,0.05);
                    \draw[-](x2)-- ++(0,-0.05);

                    \path[name path=x2tox3](posphix2)--+(2,0);
                    \path[name intersections={of=x2tox3 and line,by=posyx3}];
                    \draw[->] (posphix2)--(posyx3);

                    \path[name path=findy3](posyx3)--+(-4,0);
                    \path[name intersections={of=findy3 and yaxis,by=y3}];
                    \draw[dashed] (posyx3)--(y3);
                    \node[anchor = east] at (y3) {\small{$\varphi(x_2) = y_3 = x_3$}}
                \end{tikzpicture}
                \caption*{\centering Para certas $\varphi(x)$, o processo pode gerar uma sequência $\{x_k\}$ que diverge de $\xi$}
            \end{subfigure}
		\end{figure}

        Exemplos:
        \begin{enumerate}[label=\textbf{(\alph*)}]
            \item $\xi = 2$, $\varphi_1(x) = 6 - x^2$, $x_0 = 1,5$
                \begin{align*}
                    x_1 = \varphi_2(x_0) &= 3,75\\
                    x_2 = \varphi_2(x_1) &= -8,0625\\
                    x_3 = \varphi_2(x_2) &= -59,003906
                \end{align*}
                $\{x_k\}$ não está convergindo para $\xi = 2$.

            \item $\xi = 2$, $\varphi_2(x) = \sqrt{6-x}$, $x_0 = 1,5$
                \begin{align*}
                    x_1 = \varphi_2(x_0) &= 2,12132\\
                    x_2 = \varphi_2(x_1) &= 1,96944\\
                    x_3 = \varphi_2(x_2) &= 2,00763\\
                    x_4 = \varphi_2(x_3) &= 1,99809\\
                    x_5 = \varphi_2(x_4) &= 2,0048\\
                \end{align*}
                $\{x_k\}$ está convergindo para $\xi = 2$.
        \end{enumerate}

        \paragraph{Teorema:} Seja $\xi$ uma raiz de $f(x)=0$ isolada em um intervalo $I$ centrado em $\xi$. Seja $\varphi(x)$ uma função de iteração para $f(x)=0$.

        Se:
        \begin{enumerate}[label= (\roman*)]
            \item $\varphi$ e $\varphi'(x)$ são contínua em $I$.
            \item\label{teorema_59_item_2} $\varphi'(x)| \leq M \leq 1,~\forall x \in I$.
            \item $x_0 \in I$.
        \end{enumerate}
        Então, a sequência $\{x_k\}$ gerada pelo processo iterativo $x_{k+1}=\varphi(x_k)$ converge para $\xi$.

        \paragraph{Demonstração:}Ver Ruggiero, página 59.
        \begin{description}
            \item 1º Mostra que se $x_0 \in I \Rightarrow x_k \in I,~\forall k$
            \item 2º Mostra que $\lim_{k \to \infty}{x_k} = \xi$
        \end{description}

        \underline{Exemplo:} $f(x) = x^2 + x - 6$, $\xi = 2$
        \begin{enumerate}
            \item $\varphi_1(x) = 6 - x^2$\\
                    $\varphi_1'(x) = -2x$\\
                    $\varphi_1(x)$ e $\varphi_1'(x)$ são contínuas em $\mathbb{R}$.
                    \begin{align*}
                        |\varphi_1'(x)| < 1 \iff |-2x| < 1 \iff -1 &< -2x < 1\\
                        - \frac{1}{2} &< x < \frac{1}{2}\\
                        \frac{1}{2} &> x > - \frac{1}{2}
                    \end{align*}

                    $\nexists$ intervalo $I$ centrado em $\xi = 2$ tal que $|\varphi_1'(x)| < 1,~\forall x \in I$.\\
                    $\therefore \varphi_1(x)$ não satisfaz o item~\ref{teorema_59_item_2} do teorema. Então não há convergência.
            \item $\varphi_2(x) = {(6-x)}^{\frac{1}{2}}$\\
                    $\varphi_2'(x) = \frac{1}{2\sqrt{6 - x}}$\
                    $\varphi_2(x)$ é contínua em $S = \{x \in \mathbb{R} / x \leq 6\}$\\
                    $\varphi_2'(x)$ é contínua em $S' = \{x \in \mathbb{R} / x \< 6\}$\\
                    \begin{align*}
                        |\varphi_2'(x)| < 1 \iff |\frac{1}{2\sqrt{6-x}}| < 1 \iff \frac{1}{2\sqrt{6-x}} &< 1\\
                        x &< 5,75
                    \end{align*}

                    $\therefore$ é impossível obter um intervalo $I$ centrado em $\xi = 2$ tais que as condição do teorema são satisfeitas.
        \end{enumerate}

        \paragraph{Critério de Parada para o MPF:}
        \begin{itemize}
            \item $|x_k - x_{k-1} = |\varphi(x_{k-1}) - x_{k-1}| < \varepsilon$ (erro absoluto)
            \item $|f(x_k)| < \varepsilon$
        \end{itemize}

        \paragraph{\underline{Exercício:}} Determinar uma raiz de $x^2 - 2^x = 0$ pelo MPF, com erro absoluto inferior a $\varepsilon = 0.6 \times 10^{-3}$, no intervalo $[-1, 0]$. $\xi = -0.76658$
        \begin{align*}
            x^2 - 2^x &= 0\\
            x^2 &= 2^x\\
            x & = \pm \sqrt{2^x}
        \end{align*}
        $\varphi(x) = -\sqrt{2^x}$: Função de iteração $-\sqrt{}$ pois sabe-se que a raíz é negativa (intervalo vai de $-1$ a $0$).

        \begin{align*}
            x_0 &= -0.5\\
            x_1 &= \varphi(x_0) = -\sqrt{2^{-0.5}} = -0.84089            &       \varepsilon &= |-0.84089 - (-0.5)| = 0.34089\\
            x_2 &= \varphi(x_1) = -\sqrt{2^{-0.84089}} = -0.74719        &       \varepsilon &= |-0.74719 - (-0.84089)| = 0.0937\\
            x_3 &= \varphi(x_2) = -\sqrt{2^{-0.74719}} = -0.77185        &       \varepsilon &= |-0.77185 - (-0.74719)| = 0.02466\\
            x_4 &= \varphi(x_3) = -\sqrt{2^{-0.77185}} = -0.76528        &       \varepsilon &= |-0.76528 - (-0.77185)| = 0.00657\\
            x_5 &= \varphi(x_4) = -\sqrt{2^{-0.76528}} = -0.76703        &       \varepsilon &= |-0.76703 - (-0.76528)| = 0.00175\\
            x_6 &= \varphi(x_5) = -\sqrt{2^{-0.76703}} = -0.76656        &       \varepsilon &= |-0.76656 - (-0.76703)| = 0.0004\\
            &                                                            &       \varepsilon &= \boxed{0.0004 < 0.0006} \text{\textbf{ (Pare!)}}\\
        \end{align*}

        Uma das raizes de $x^2 - 2^x = 0$ é $x = -0.76656$.

        \begin{figure}[H]
            \centering
            \begin{tikzpicture}
                \begin{axis}[
                    axis lines = center,
                    xlabel = $x$,
                    ylabel = {$f(x)$},
                    legend pos = north west,
                    ]
                    \addplot[
                    domain=-2:1, 
                    samples=100, 
                    color=blue,
                    ]
                    {x};
                    \addlegendentry{$y = x$};
                    \addplot[
                    domain=-2:1, 
                    samples=100, 
                    color=red,
                    ]
                    {-sqrt(2^x)};
                    \addlegendentry{$\varphi(x) = -\sqrt{2^x}$};
                \end{axis}
            \end{tikzpicture}
            \caption*{Visualização gráfica das funções $x=y$ e $\varphi(x) = -\sqrt{2^x}$}
        \end{figure}

        \subsubsection{Método de Newton}
            \begin{figure}[H]
                \centering
                \begin{tikzpicture}[>=latex']

                    \draw[->, name path=yaxis](0,-0.25)--(0,4) node[anchor=east]{$y = f(x)$};
                    \draw[->, name path=xaxis](-0.25,0)--(4.5,0) node[anchor=north]{$x$};

                    \draw[-, color=grey, name path=line](1,-0.25)--(4.3986,4) node[text width=2cm,anchor=north west]{tangente à curva $f$ no ponto $x_k$};
                    \draw[color=red, name path=fx] (-0.25,-0.25) to[bend right] (3.5,4) node[anchor=south west] {$f(x)$};

                    \path[name intersections={of=xaxis and fx,by=xi}];

                    \node[anchor=north] at(xi) {$\xi$};
                    \draw[-](xi)-- ++(0,0.05);
                    \draw[-](xi)-- ++(0,-0.05);

                    \path[name intersections={of=fx and line,by=xkpos}];
                    \path[name path=findxk](xkpos)--+(0,-2);
                    \path[name intersections={of=findxk and xaxis,by=xk}];

                    \node[anchor=north] at (xk){$x_k$};
                    \draw[-](xk)-- ++(0,0.05);
                    \draw[-](xk)-- ++(0,-0.05);

                    \path[name path=findfxk](xkpos)--+(-4,0)
                    \path[name intersections={of=findfxk and yaxis,by=fxk}];
                    \draw[dashed] (xkpos)--(fxk) node[anchor=east]{$f(x_k)$};
                    \draw[dashed] (xkpos)--(xk);

                    \path[name intersections={of=xaxis and line,by=nextxk}];
                    \node[anchor=north west]at (nextxk){$x_{k+1}$}
                    \draw[-](nextxk)-- ++(0,0.05);
                    \draw[-](nextxk)-- ++(0,-0.05);

                    \pic [draw] {angle = xk--nextxk--xkpos};
                    \node[anchor=south west]at([yshift=-1mm,xshift=1mm]nextxk){\small{$\theta$}};

                \end{tikzpicture}
            \end{figure}

            \begin{multicols}{2}
                Sabemos que a derivada é a inclinação da reta tangente:
                \[\tan{\theta} = f'(x)\]
                \vfill
                \begin{figure}[H]
                    \centering
                    \begin{tikzpicture}
                        \coordinate (a) at (0,0);
                        \coordinate (b) at (2,0);
                        \coordinate (c) at (2,2);

                        \draw (c)--(b)--(a)--cycle;
                        \pic[draw] {angle= b--a--c};
                        \node[anchor=south west]at([yshift=-1mm,xshift=1mm]a){\small{$\theta$}};

                        \node[anchor=west] (fx) at ($(b)!0.5!(c)$) {$f(x_k)$};
                        \node[anchor=north] (xminusx) at ($(a)!0.5!(b)$) {$x_{k} - x_{k+1}$};
                    \end{tikzpicture}
                \end{figure}
            \end{multicols}

            \begin{align*}
                \shortintertext{Por outro lado, no triângulo, temos:}
                \tan{\theta} = \frac{\text{cateto oposto}}{\text{cateto adjacente}} &= \frac{f(x_{k})}{x_{k} - x_{k+1}}\\
                \shortintertext{Então, temos:}
                \tan{\theta} = f'(x_k) &= \frac{f(x_k)}{x_k - x_{k+1}}\\
                x_k - x_{k+1} &= \frac{f(x_k)}{f'(x_k)}\\
                x_k &= x_{k+1} - \frac{f(x_k)}{f'(x_k)},~k=0,1,2, \ldots\\
            \end{align*}

            \paragraph{Dedução como um Método de Ponto Fixo:}
            Visto que a função de iteração é dada por:
            \[\varphi(x) = x + A(x).f(x)\]
            com $A(\xi) \neq 0$ e com $\xi$ ponto fixo de $\phi(x)$.

            A função de iteração ideal satisfaz a condição $\varphi'(\xi) = 0$. Assim,
            \begin{align*}
                \varphi(x) &= x + A(x).f(x)\\
                \shortintertext{Aplicando a regra do produto na derivada:}
                \varphi'(x) &= 1 + A'(x).f(x) + A(x).f'(x)\\
            \end{align*}

            Vimos que MPF tem convergência garantida para
            \[|\varphi(x)| < 1,~\forall x \in I \text{ centrado na raiz}\]

            Aconvergência é mais rápida quanto menor for $|\varphi'(\xi)|$. Assim, se escolhermos $A(x)$ tal que $\varphi'(\xi) = 0$, teremos garantia de convergência.

            Assim:
            \begin{gather*}
                \varphi'(\xi) = 0\\
                1 + A'(\xi).f(\xi) + A(\xi).f'(\xi) = 0\\
                1 + A(\xi).f'(\xi) = 0\\
                A(\xi) = \frac{-1}{f'(\xi)}
            \end{gather*}
            
            Então, a função $A$ é dada por: $A(x) = \frac{-1}{f'(x)}$ e a função da iteração correspondente é:
            \[\varphi(x) = x - \frac{1}{f'(x)}.f(x) = \boxed{x - \frac{f(x)}{f'(x)}}\]
            e a sequência de aproximações $x_k$ é gerada por:
            \[\boxed{x_{k+1} = \varphi(x_k) \iff x_{k+1} = x_k - \frac{f(x_k)}{f'(x_k)}}\]

            \paragraph{Por série de Taylor:}
            Série de taylor de $f(x)$ em torno do ponto $x =a$
            \begin{align*}
                f(x) &\simeq f(a) + \frac{f'(a)}{1!}(x-a) + \frac''{f(a)}{2!}{(x-a)}^2 + \cdots\\
                &= \sum_{n = 0}^{\infty} \frac{f^{(n)}(a)}{n!}.{(x - a)}^n
            \end{align*}
            para $a = 0$ temos séried e MacLaurin.

            A partir de um ponto inicial $x_0$, a cada iteração $k$, construímos a aproximação de $f$ por série de Taylor, em torno de $x_k$:
            \[f(\underline{x}) \sim r(\underline{x}) = f(x_k) + f'(x_k).(\underline{x} - x_k)\]

            O próximo novo ponto é obtido tal que
            \begin{align*}
                r(x_{k+1}) = 0 &\iff f(x_k) + f'(x_k).(x_{k+1}-x_k) = 0\\
                               &\iff f'(x_k)(x_{k+1} - x_k) = -f(x_k)\\
                               &\iff (x_{k+1} - x_k) = -\frac{f(x_k)}{f'(x_k)}\\
                               &\iff \boxed{x_{k+1} = x_k - \frac{f(x_k)}{f'(x_k)}}\\
            \end{align*}
           
            \subsubsection*{Algoritmo do Método de Newton} %convergência quadrática

            \paragraph{Teorema:} Sejam $f$, $f'$ e $f''$ contínuas em um intervalo $I$ que contém a raiz $\xi$ de $f$. Supor $f'(\xi) \neq 0$.

            Então existe um intervalo $I_2 \subset I$, contendo a raiz $\xi$, tal que: Para $x_0 \in I_2$, a sequência $x_k$ gerada pelo método de Newton $(x_{k+1} = x_k - \frac{f(x_k)}{f'(x_k)})$ converge para a raiz.

            \paragraph{Taxa de convergência quadrática:} Para $k \to \infty$, a sequência gerada pelo Método de Newton converge para a raiz $\xi$, então:
            \[|x_{k+1} - \xi| < C \times {|x_k - \xi|}^{\underline{2}~\to \text{\textit{ (convergência quadrática)}}}\]
            em que $C$ é uma constante real positiva. Essa propriedade é assintótica e, no limite, os dígitos corretos dasa aproximações praticamente dobram de uma iteração para a outra.

            \paragraph{Exemplo:} Use o Método de Newton para calcular o valor de $\sqrt{2}$ com erro $\varepsilon = 10^{-6}$, partindo de $x_0 = 1.4$
            \[x = \sqrt{2} \iff x^2 - 2 = 0 \iff f(x) = x^2 - 2 = 0\]
            \hfill $\sqrt{2} \cong 1.414213562373$

            \begin{gather*}
                f(x) = x^2 - 2\\
                f'(x) = 2x\\
            \end{gather*}
            
            Método de Newton: 
            \[x_{k+1} = x_k - \frac{-f(x_k)}{f'(x_k)} = x_k - \frac{({x_k}^2 - 2)}{2x_k} = \frac{{x_k}^2 + 2}{2x_k}\]

            \begin{align*}
                x_0 &= 1.4\\
                x_1 &= \frac{{x_0}^2 + 2}{2x_0} = \frac{{1.4}^2 + 2}{2 \times 1.4} = 1.41428571429      &       \varepsilon_1 &= |x_1 - x_0| = 0.01928571429\\
                x_2 &= \frac{{1.41428571429}^2 + 2}{2 \times 1.41428571429} = 1.41421356421             &       \varepsilon_2 &= |x_2 - x_1| = 0.00007215\\
                x_3 &= \frac{{1.41421356421}^2 + 2}{2 \times 1.41421356421} = 1.41421356237             &       \varepsilon_3 &= |x_3 - x_2| = 2.7 \times 10^{-9} < \varepsilon\\
            \end{align*}

            \paragraph{\underline{Exercícios:}} Determine o ponto inicial pelo método gráfico e considere $\varepsilon = 0.001$. (Atenção! Calculadora em radianos)
            \begin{enumerate}[label=\textbf{ (\alph*)}]
                \item $f(x) = x - e^{-x} = 0$
                \item $f(x) = \cos{(x)} - x = 0$
            \end{enumerate}

\end{document}
